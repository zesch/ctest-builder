<div fxLayout="column"
  fxLayoutAlign="space-between space-between"
  fxLayoutGap="10px">

  <!-- removed until fixed in backend.
  <div *ngIf="(this.warnings$ | async)">
    <h5>Info:</h5>
    <p>
      <span *ngFor="let warning of (warnings$ | async)" style="color: rgb(255, 66, 66);">{{warning}}<br></span>
    </p>
  </div>
  -->

  <mat-card #controlPanel
    class="control-panel"
    fxLayoutAlign="space-between center"
    fxLayoutGap="25px">

    <div fxLayoutAlign="center center">
      <button mat-button
        fxFlex="1 1 50%"
        (click)="this.stateService.undo()"
        [disabled]="!this.stateService.hasUndo"
        matTooltip="undo last change">
        <mat-icon>undo</mat-icon>
      </button>

      <button mat-button
        fxFlex="1 1 50%"
        (click)="this.stateService.redo()"
        [disabled]="!this.stateService.hasRedo"
        matTooltip="redo last change">
        <mat-icon>redo</mat-icon>
      </button>
    </div>

    <div class="vertical-divider"></div>

    <mat-slide-toggle
      [(ngModel)]="showPreview"
      color="primary">
      Preview Mode
    </mat-slide-toggle>

    <div class="vertical-divider"></div>

    <span>Words: {{ ("" + this.words.length).padStart(3," ") }}</span>

    <div>
      <span>Gaps: {{ ("" + this.gaps).padStart(3," ") }}</span>
      <button mat-icon-button
        (click)="this.updateAllGaps()"
        matTooltip="recalculate all gap positions">
        <mat-icon>sync</mat-icon>
      </button>
    </div>

  </mat-card>



  <mat-card class="text_editor">
    <div class="ngx-dnd-container"
      *ngIf="!showPreview"
      ngxDroppable
      (drop)="this.onDrop($event)">

      <!-- Draggable Words  -->
      <ng-container *ngFor="let word of words">
        <tp-token
          [token]="word"
          (gapChange)="updateGaps($event)"
          (modify)="onTokenModification($event)"
          (delete)="onTokenDeletion($event)"
          ngxDraggable
          [model]="word">
        </tp-token>
      </ng-container>

      <button mat-mini-fab
        (click)="addNewWord()"
        color="primary">
        <mat-icon matTooltip="Add new word next">add</mat-icon>
      </button>
    </div>
    <div *ngIf="showPreview">
      <p>
        <ng-container *ngFor="let word of words">
          {{ word | testview }}
        </ng-container>
      </p>
    </div>
  </mat-card>

  <div>
    <tp-export [words]="this.words"></tp-export>

    <button mat-raised-button
      (click)="this.routeToHome()">
      New C-Test
    </button>
  </div>
</div>
